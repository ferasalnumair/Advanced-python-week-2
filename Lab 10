import pandas as pd
import numpy as np
def iqr_bounds(series, k=1.5):
    q1 = series.quantile(0.25)
    q3 = series.quantile(0.75)
    iqr = q3 - q1
    lower = q1 - k * iqr
    upper = q3 + k * iqr
    return lower, upper
def detect_outliers_iqr(df, col, k=1.5):
    lower, upper = iqr_bounds(df[col], k)
    return (df[col] < lower) | (df[col] > upper)
def cap_outliers(df, col):
    lower, upper = iqr_bounds(df[col])
    df[col] = df[col].clip(lower, upper)
    return df
def log_transform(df, col):
    df[col] = np.log1p(df[col])
    return df
